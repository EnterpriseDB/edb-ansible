# Original work Copyright 2019-2020, EnterpriseDB Corporation
#
# Installs Roles and Collections requirements
# ansible-galaxy install --force -r requirements.yml
#
# pip install openshift pyyaml kubernetes
# pip install pyhelm
---
- name: Manage a CloudNativePG or CloudNative Postgres Cluster Playbook
  hosts: localhost
  gather_facts: false

  collections:
    - edb_devops.edb_postgres

  vars:
    # Options"
    # add-db, add-schema, add-role
    # drop-db, drop-schema, drop-role
    - cnp_task: drop-db
    # CloudNativePG Namespace
    - cnpg_namespace: default
    # CloudNativePG Pod Name
    - pod_name: cluster-example-1
    # Databases
    - db_name: edb
    # Schemas
    - schema_name: edb_schema
    # Roles
    - db_role: edb_role
    - db_role_password: admin

  roles:
    - role: manage_cnp
      when: 
        - cnp_task is defined
