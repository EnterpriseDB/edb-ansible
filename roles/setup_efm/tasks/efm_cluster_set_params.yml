---
- name: Set the efm parameters
  include_tasks: efm_set_params.yml
  when:
    - efm_parameters|length > 0

- name: Stop the efm service on nodes
  systemd:
    name: "{{ efm_service }}"
    enabled: yes
    state: stopped
  when:
    - efm_parameters|length > 0
    - properties_changes is defined
    - properties_changes.changed
  become: yes

- name: Start the efm service on nodes
  systemd:
    name: "{{ efm_service }}"
    enabled: yes
    state: started
  when:
    - efm_parameters|length > 0
    - properties_changes is defined
    - properties_changes.changed
  become: yes
